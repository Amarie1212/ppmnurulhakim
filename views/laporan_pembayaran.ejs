<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title><%= title %></title>
  <link rel="icon" type="image/png" href="/img/logo ppm.png" />
  
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="/styles.css" />
  <link rel="stylesheet" href="/duty.css" />
  
  <script>
    // Image Zoom Styled (Boxed)
  function openZoom(src) {
    const modal = document.createElement('div');
    modal.style.cssText = `
      position: fixed; inset: 0; z-index: 10000;
      background: rgba(0, 0, 0, 0.85); backdrop-filter: blur(8px);
      display: flex; align-items: center; justify-content: center;
      padding: 20px;
      opacity: 0; transition: opacity 0.3s ease;
    `;
    
    const box = document.createElement('div');
    box.style.cssText = `
      background: var(--bg-2, #27272a);
      border: 1px solid var(--border, rgba(255,255,255,0.1));
      border-radius: 12px;
      overflow: hidden;
      max-width: 100%; width: auto;
      box-shadow: 0 25px 50px rgba(0,0,0,0.5);
      display: flex; flex-direction: column;
      transform: scale(0.95); transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    `;
    
    const header = document.createElement('div');
    header.style.cssText = `
      display: flex; align-items: center; justify-content: space-between;
      padding: 12px 16px;
      border-bottom: 1px solid var(--border, rgba(255,255,255,0.1));
      background: var(--bg-2, #27272a);
    `;
    
    const title = document.createElement('span');
    title.textContent = 'Bukti Pembayaran';
    title.style.cssText = 'font-weight: 700; font-size: 0.95rem; color: var(--text, #fff);';
    
    const closeBtn = document.createElement('button');
    closeBtn.innerHTML = 'Ã—';
    closeBtn.style.cssText = `
      background: transparent; border: 1px solid var(--border, rgba(255,255,255,0.1));
      color: var(--text, #fff); width: 28px; height: 28px;
      border-radius: 6px; display: flex; align-items: center; justify-content: center;
      cursor: pointer; font-size: 1.2rem; line-height: 1; padding-bottom: 2px;
    `;
    closeBtn.onmouseover = () => closeBtn.style.background = 'rgba(255,255,255,0.05)';
    closeBtn.onmouseout = () => closeBtn.style.background = 'transparent';
    
    header.appendChild(title);
    header.appendChild(closeBtn);
    
    const body = document.createElement('div');
    body.style.cssText = 'padding: 0; background: #000; display: flex; justify-content: center; position: relative;';
    
    const img = document.createElement('img');
    img.src = src;
    img.style.cssText = 'max-width: 100%; max-height: 80vh; object-fit: contain; display: block;';
    
    body.appendChild(img);
    box.appendChild(header);
    box.appendChild(body);
    modal.appendChild(box);
    document.body.appendChild(modal);
    document.body.style.overflow = 'hidden';
    
    requestAnimationFrame(() => {
      modal.style.opacity = '1';
      box.style.transform = 'scale(1)';
    });
    
    const close = () => {
      modal.style.opacity = '0';
      box.style.transform = 'scale(0.95)';
      document.body.style.overflow = '';
      setTimeout(() => modal.remove(), 300);
    };
    
    modal.onclick = (e) => { if (e.target === modal) close(); };
    closeBtn.onclick = close;
  }
  </script>
  
  <style>
    /* Tab Styling */
    /* Tab Styling (EXACT COPY from verifikasi.ejs) */
    .tab-container { margin-bottom: 20px; }
    .tab-buttons {
      display: flex;
      gap: 10px;
      background: var(--bg-2);
      border: 1px solid var(--border);
      border-radius: 4px; /* Reverted */
      padding: 6px;
    }
    .tab-btn {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      padding: 12px 16px !important; /* EXACT match verifikasi.ejs (Enforced) */
      border: none;
      border-radius: 4px !important; /* EXACT match verifikasi.ejs (Enforced) */
      background: transparent;
      color: var(--muted);
      font-weight: 600 !important; /* EXACT match verifikasi.ejs (Enforced) */
      font-size: 0.9rem !important; /* EXACT match verifikasi.ejs (Enforced) */
      line-height: 1.5;
      cursor: pointer;
      transition: all 0.2s;
    }
    .tab-btn svg { width: 18px; height: 18px; }
    .tab-btn:hover { background: var(--bg); color: var(--text); }
    .tab-btn.active { background: var(--accent); color: #000; }
    .tab-content { display: none; }
    .tab-content.active { display: block; }
    

    /* Mobile responsive */
    @media (max-width: 768px) {
      .page-header { 
        flex-direction: column; 
        align-items: stretch !important; 
        gap: 16px; 
        margin-bottom: 20px !important;
      }
      /* ANIMATION */
      /* @keyframes popIn REMOVED FROM HERE */
    }
    
    /* Button Styles (Matched Laporan Masuk) */
    .btn-small { padding: 8px 16px; border-radius: 6px; font-size: 0.85rem; font-weight: 600; cursor: pointer; border: none; transition: all .2s; }
    .btn-detail-link { background: rgba(59, 130, 246, 0.1); color: #3b82f6; border: 1px solid rgba(59, 130, 246, 0.15); }
    .btn-detail-link:hover { background: #3b82f6; color: #fff; }

    /* ANIMATION (Global) */
    @keyframes popIn {
      0% { opacity: 0; transform: scale(0.95) translateY(10px); }
      100% { opacity: 1; transform: scale(1) translateY(0); }
    }
    
    .table-card {
      background: var(--bg-2); /* Match Pengurus */
      border: 1px solid var(--border);
      border-radius: 8px;
      overflow: hidden;
      animation: popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
    }
    
    /* SCROLL WRAPPER (Match Pengurus) */
    .table-responsive {
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
      width: 100%;
    }

    /* Make table compact/rapat (Match Pengurus) */
    .table th { padding: 12px 16px !important; }
    .table td { padding: 10px 16px !important; }
    
    /* Remove Bold from Name (Match Pengurus) */
    .cell-nama { font-weight: 400 !important; }

    /* Mobile responsive */
    @media (max-width: 480px) {
      .table { min-width: 500px; }
      .table th, .table td {
        font-size: 0.8rem !important; /* Standardized */
        padding: 12px 10px !important;
      }
      .page-title { font-size: 1.3rem !important; margin: 0 !important; }
      .btn-export { width: 100%; justify-content: center; }
    }

    @media (max-width: 768px) {
      /* Stat cards smaller */
      .stat-row { gap: 10px !important; flex-wrap: wrap; }
      .stat-card { 
        padding: 12px 16px !important; 
        min-width: 100px; 
        flex: 1;
      }
      .stat-card .value { font-size: 1.4rem !important; }
      .stat-card .label { font-size: 0.7rem !important; }
      
      /* Tab buttons */
    .tab-btn { 
        padding: 10px 12px; 
        font-size: 0.75rem; 
        gap: 4px;
      }
      .tab-btn svg { width: 14px; height: 14px; }
    }
    
    /* MODAL OVERLAY (Essential for visibility) */
    .modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.5); /* Semi-transparent dark bg */
      backdrop-filter: blur(2px);
      z-index: 9999;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0; /* Animated by JS */
      transition: opacity 0.2s ease;
    }

    /* TOOLBAR (Search & Filter) - Matched Laporan Santri */
    .toolbar {
      display: flex; gap: 12px; margin-bottom: 24px; align-items: center; flex-wrap: wrap;
    }
    .search-group { position: relative; flex: 1; min-width: 200px; }
    .search-group svg {
      position: absolute; left: 14px; top: 50%; transform: translateY(-50%);
      color: var(--muted); width: 18px; height: 18px; pointer-events: none;
    }
    .search-input {
      width: 100%; padding: 12px 16px 12px 42px;
      border-radius: 12px; border: 1px solid var(--border);
      background: var(--bg-2); color: var(--text);
      font-size: 0.95rem; font-weight: 500;
      transition: all 0.2s;
    }
    .search-input:focus {
      border-color: var(--accent); outline: none;
      box-shadow: 0 0 0 4px rgba(34, 197, 94, 0.1);
    }
    
    .filter-group { display: flex; gap: 12px; }
    .filter-select {
      appearance: none; padding: 12px 40px 12px 16px;
      border-radius: 12px; border: 1px solid var(--border);
      background: var(--bg-2) url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%2364748b' stroke-width='2.5'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='M19.5 8.25l-7.5 7.5-7.5-7.5' /%3E%3C/svg%3E") no-repeat right 12px center;
      background-size: 16px; color: var(--text);
      font-size: 0.9rem; font-weight: 600; cursor: pointer;
      min-width: 150px; transition: all 0.2s;
    }
    .filter-select:focus { border-color: var(--accent); outline: none; }

    .btn-export {
      padding: 12px 20px; border-radius: 12px;
      background: var(--accent); color: #000 !important;
      font-weight: 700; text-decoration: none;
      display: inline-flex; align-items: center; gap: 10px;
      transition: none; border: none; font-size: 0.9rem; cursor: pointer;
      outline: none; box-shadow: none;
    }
    .btn-export:hover, .btn-export:focus, .btn-export:active {
      background: var(--accent);
      outline: none !important;
      box-shadow: none !important;
      border: none !important;
      transform: none !important;
      filter: none !important;
      opacity: 1 !important;
    }
  </style>
</head>
<body>

<header class="navbar">
  <div class="container nav-inner">
    <div class="brand-wrap">
      <a href="/pengurus/home" class="btn-back-inline" title="Kembali">
        <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 18l-6-6 6-6"/></svg>
      </a>
      <div class="brand">Laporan Pembayaran</div>
    </div>
    <div class="right-actions">
      <button id="navToggle" class="nav-toggle" style="display:flex !important;" aria-label="Menu">
        <div class="bar"></div><div class="bar"></div><div class="bar"></div>
      </button>
    </div>
  </div>
</header>

<%- include('partials/pengurus_sidebar', { currentPage: 'laporan-bayar', user: user, stat: null }) %>

<main class="section">
  <div class="container">
    
    <!-- TAB SWITCHER -->
    <div class="tab-container">
      <div class="tab-buttons">
        <button class="tab-btn <%= activeTab === 'sudah' ? 'active' : '' %>" onclick="switchTab('sudah')">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
          Sudah Bayar (<%= pembayaran.length %>)
        </button>
        <% if (user.role !== 'ketua' && belumBayar) { %>
        <button class="tab-btn <%= activeTab === 'belum' ? 'active' : '' %>" onclick="switchTab('belum')">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="15" y1="9" x2="9" y2="15"/><line x1="9" y1="9" x2="15" y2="15"/></svg>
          Belum Bayar (<%= belumBayar.length %>)
        </button>
        <% } %>
      </div>
    </div>

    <!-- TOOLBAR (Search & Filter) -->
    <% if ((typeof pembayaran !== 'undefined' && pembayaran.length > 0) || (typeof belumBayar !== 'undefined' && belumBayar.length > 0) || (typeof search !== 'undefined' && search) || (typeof bulan !== 'undefined' && bulan)) { %>
    <form id="filterForm" method="GET" action="/pengurus/laporan-pembayaran" class="toolbar">
      <input type="hidden" name="tab" value="<%= activeTab %>">
      
      <div class="search-group">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><circle cx="11" cy="11" r="8"/><path d="M21 21l-4.35-4.35"/></svg>
        <input type="text" name="search" class="search-input" placeholder="Cari nama santri..." value="<%= search %>">
      </div>
      
      <div class="filter-group">
        <select name="month" class="filter-select" style="min-width: 140px;">
          <option value="">Semua Bulan</option>
          <% months.forEach(m => { %>
            <option value="<%= m.value %>" <%= month === m.value ? 'selected' : '' %>><%= m.name %></option>
          <% }) %>
        </select>

        <select name="year" class="filter-select" style="min-width: 100px;">
          <option value="">Semua Tahun</option>
          <% years.forEach(y => { %>
            <option value="<%= y %>" <%= year === y ? 'selected' : '' %>><%= y %></option>
          <% }) %>
        </select>
        
      </div>
    </form>
    <% } %>
    
    <!-- TAB CONTENT: SUDAH BAYAR -->
    <div id="tab-sudah" class="tab-content <%= activeTab === 'sudah' ? 'active' : '' %>">
      <% if(pembayaran.length === 0) { %>
        <div class="empty-state">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <path d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
          </svg>
          <h4>Belum ada data</h4>
          <p>Verifikasi pembayaran dulu di menu Verifikasi Pembayaran</p>
        </div>
      <% } else { %>
        <div class="table-card">
          <div class="table-responsive">
            <table class="table">
              <thead>
                <tr>
                  <th style="text-align:center" width="60">No</th>
                  <th width="100" style="text-align:center">Bukti</th>
                  <th style="text-align:left">Nama Santri</th>
                  <th style="white-space: nowrap; text-align:center;">Tanggal Upload</th>
                  <th style="text-align:center" width="100">Aksi</th>
                </tr>
              </thead>
              <tbody>
                <% pembayaran.forEach((p, i) => { %>
                  <tr>
                    <td style="text-align:center; color:var(--muted); font-size:0.9rem"><%= i + 1 %></td>
                    <td style="text-align:center">
                      <div style="display:flex; justify-content:center;">
                        <button type="button" onclick="openZoom('<%= p.bukti_path %>')" style="background:transparent; border:1px solid var(--border); border-radius:50px; padding:4px 12px 4px 4px; display:flex; align-items:center; gap:8px; cursor:pointer; font-size:0.8rem; font-weight:600; width:auto; color:var(--text); transition:all .2s;">
                          <img src="<%= p.bukti_path %>" style="width:24px; height:24px; object-fit:cover; border-radius:50%;">
                          Lihat
                        </button>
                      </div>
                    </td>
                    <td class="cell-nama" style="text-align:left"><%= p.nama_santri %></td>
                    <td style="text-align:center; color:var(--muted); font-size:0.85rem; white-space: nowrap;"><%= p.tanggal_upload %></td>
                    <td style="text-align:center">
                      <div style="display:flex; justify-content:center;">
                        <button type="button" 
                          class="btn-small btn-detail-link btn-show-detail"
                          data-nama="<%= p.nama_santri %>"
                          data-pengirim="<%= p.nama_pengirim || '-' %>"
                          data-bank="<%= p.nama_bank || '-' %>"
                          data-rekening="<%= p.nomor_rekening || '-' %>"
                          data-tgl-transfer="<%= p.tanggal_transfer || '-' %>"
                          data-tgl-upload="<%= p.tanggal_upload %>"
                          data-bukti="<%= p.bukti_path %>">
                          Detail
                        </button>
                      </div>
                    </td>
                  </tr>
                <% }) %>
              </tbody>
            </table>
          </div>
        </div>
      <% } %>
    </div>
    
    <% if (user.role !== 'ketua' && belumBayar) { %>
    <!-- TAB CONTENT: BELUM BAYAR -->
    <div id="tab-belum" class="tab-content <%= activeTab === 'belum' ? 'active' : '' %>">
      <% if(belumBayar.length === 0) { %>
        <div class="empty-state" style="border-color: var(--accent);">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
          </svg>
          <h4>Semua santri sudah bayar!</h4>
          <p>Tidak ada santri yang belum membayar.</p>
        </div>
      <% } else { %>
        <div class="table-card">
          <div class="table-responsive">
            <table class="table">
              <thead>
                <tr>
                  <th style="text-align:center" width="60">No</th>
                  <th style="text-align:left">Nama Santri</th>
                  <th style="text-align:center">Kontak</th>
                </tr>
              </thead>
              <tbody>
                <% belumBayar.forEach((s, i) => { %>
                  <tr>
                    <td style="text-align:center; color:var(--muted); font-size:0.9rem"><%= i + 1 %></td>
                    <td class="cell-nama" style="text-align:left"><%= s.nama %></td>
                    <td style="text-align:center">
                      <% if (s.wa) { %>
                        <a href="https://wa.me/<%= s.wa.replace(/^0/, '62').replace(/\D/g, '') %>" target="_blank" style="color:var(--accent); text-decoration:none; display:inline-flex; align-items:center; gap:6px; font-weight:500;">
                          <svg viewBox="0 0 24 24" fill="currentColor" width="16" height="16" style="margin-top:-1px">
                            <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L0 24l6.304-1.654a11.882 11.882 0 005.713 1.456h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/></svg><%= s.wa %>
                        </a>
                      <% } else { %>
                        <span style="color: var(--muted);">-</span>
                      <% } %>
                    </td>
                  </tr>
                <% }) %>
              </tbody>
            </table>
          </div>
        </div>
      <% } %>
    </div>
    <% } %>
  </div>
</main>

<button id="themeFab" class="theme-fab"></button>

<!-- Modal Detail (Matched Laporan Masuk Design) -->
<div id="detailModal" class="modal-overlay" style="display:none;" onclick="closeDetail()">
  <div class="modal-box" onclick="event.stopPropagation()" style="background:var(--bg-2); border:1px solid var(--border); border-radius:12px; max-width:480px; width:95%; box-shadow:0 25px 50px -12px rgba(0,0,0,0.25); overflow:hidden; transform:scale(0.95); opacity:0; transition:all 0.2s; padding:0; display:flex; flex-direction:column; max-height:90vh;">
    
    <div style="display:flex; justify-content:space-between; align-items:center; padding:16px 20px; border-bottom:1px solid var(--border);">
      <h3 style="margin:0; font-size:1.1rem; font-weight:700;">Detail Pembayaran</h3>
      <button onclick="closeDetail()" style="background:transparent; border:none; color:var(--muted); font-size:1.5rem; cursor:pointer; line-height:1; padding:4px;">&times;</button>
    </div>
    
    <div style="overflow-y:auto; flex:1;">
      <!-- Image Section -->
      <div style="padding:24px 24px 16px; text-align:center;">
        <div style="border-radius:8px; overflow:hidden; border:1px solid var(--border); display:inline-block; max-width:100%;">
          <img id="modalBukti" src="" onclick="openZoom(this.src)" style="max-height:220px; max-width:100%; display:block; cursor:zoom-in;">
        </div>
        <p style="margin:12px 0 0; font-size:0.8rem; color:var(--muted);">Klik gambar untuk memperbesar</p>
      </div>

      <!-- Info Header -->
      <div style="padding:0 24px 16px;">
        <div style="display:flex; align-items:center; gap:8px; border-bottom:2px solid var(--border); padding-bottom:8px;">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20" height="20" style="color:var(--accent);"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
          <h4 style="margin:0; font-size:1rem; font-weight:700;">Info Pembayaran</h4>
        </div>
      </div>

      <!-- Details List -->
      <div style="padding:0 24px 24px;">
        <div class="detail-row" style="display:flex; justify-content:space-between; padding:12px 0; border-bottom:1px solid var(--border-light, rgba(0,0,0,0.05));">
          <span style="color:var(--muted); font-size:0.9rem;">Nama Santri</span>
          <span id="modalNama" style="font-weight:600; text-align:right;">-</span>
        </div>
        <div class="detail-row" style="display:flex; justify-content:space-between; padding:12px 0; border-bottom:1px solid var(--border-light, rgba(0,0,0,0.05));">
          <span style="color:var(--muted); font-size:0.9rem;">Nama Pengirim</span>
          <span id="modalPengirim" style="font-weight:500; text-align:right;">-</span>
        </div>
        <div class="detail-row" style="display:flex; justify-content:space-between; padding:12px 0; border-bottom:1px solid var(--border-light, rgba(0,0,0,0.05));">
          <span style="color:var(--muted); font-size:0.9rem;">Nama Bank</span>
          <span id="modalBank" style="font-weight:500; text-align:right;">-</span>
        </div>
        <div class="detail-row" style="display:flex; justify-content:space-between; padding:12px 0; border-bottom:1px solid var(--border-light, rgba(0,0,0,0.05));">
          <span style="color:var(--muted); font-size:0.9rem;">Nomor Rekening</span>
          <span id="modalRekening" style="font-weight:500; text-align:right;">-</span>
        </div>
        <div class="detail-row" style="display:flex; justify-content:space-between; padding:12px 0; border-bottom:1px solid var(--border-light, rgba(0,0,0,0.05));">
          <span style="color:var(--muted); font-size:0.9rem;">Tanggal Transfer</span>
          <span id="modalTglTransfer" style="font-weight:500; text-align:right;">-</span>
        </div>
        <div class="detail-row" style="display:flex; justify-content:space-between; padding:12px 0;">
          <span style="color:var(--muted); font-size:0.9rem;">Tanggal Upload</span>
          <span id="modalTanggal" style="font-weight:500; text-align:right;">-</span>
        </div>
      </div>
    </div>
    
    <div style="padding:16px 24px; border-top:1px solid var(--border); text-align:right; background:var(--bg);">
      <button onclick="closeDetail()" style="background:var(--accent); border:none; padding:10px 24px; border-radius:6px; font-size:0.95rem; font-weight:600; color:#000; cursor:pointer; width:100%;">Tutup</button>
    </div>
  </div>
</div>

<script>
  function showDetail(nama, pengirim, bank, rekening, tglTransfer, tglUpload, bukti) {
    const modal = document.getElementById('detailModal');
    const box = modal.querySelector('.modal-box');
    
    document.getElementById('modalNama').textContent = nama;
    document.getElementById('modalPengirim').textContent = pengirim;
    document.getElementById('modalBank').textContent = bank;
    document.getElementById('modalRekening').textContent = rekening;
    document.getElementById('modalTglTransfer').textContent = tglTransfer;
    document.getElementById('modalTanggal').textContent = tglUpload;
    document.getElementById('modalBukti').src = bukti;
    
    modal.style.display = 'flex';
    requestAnimationFrame(() => {
      box.style.transform = 'scale(1)';
      box.style.opacity = '1';
    });
  }

  function closeDetail() {
    const modal = document.getElementById('detailModal');
    const box = modal.querySelector('.modal-box');
    
    box.style.transform = 'scale(0.95)';
    box.style.opacity = '0';
    
    setTimeout(() => {
      modal.style.display = 'none';
    }, 200);
  }
  // Event listener for detail buttons using data attributes
  document.addEventListener('DOMContentLoaded', function() {
    document.querySelectorAll('.btn-show-detail').forEach(function(btn) {
      btn.addEventListener('click', function() {
        const d = this.dataset;
        showDetail(d.nama, d.pengirim, d.bank, d.rekening, d.tglTransfer, d.tglUpload, d.bukti);
      });
    });
  });
</script>

<script>
  function switchTab(tab) {
    // Remove active from all buttons and contents
    document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
    document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
    
    // Add active to selected tab
    if (tab === 'sudah') {
      document.querySelectorAll('.tab-btn')[0].classList.add('active');
      document.getElementById('tab-sudah').classList.add('active');
    } else {
      document.querySelectorAll('.tab-btn')[1].classList.add('active');
      document.getElementById('tab-belum').classList.add('active');
    }
    
    // Save state to URL (prevents flash on refresh)
    const url = new URL(window.location);
    url.searchParams.set('tab', tab);
    window.history.replaceState({}, '', url);
    
    // Update hidden inputs in forms
    document.querySelectorAll('input[name="tab"]').forEach(input => input.value = tab);
  }
</script>

<%- include('partials/pengurus_nav_script') %>

</body>
</html>


